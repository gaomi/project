if(void 0===G_Dci_Info)var G_Dci_Info={};require(["dojo/dom","dojo/query","dojo/on","dojo/topic","dojo/on","esri/toolbars/draw"],function(o,a,e,t,e,l){G_Dci_Info.MapToolManager={map:null,zoom_DrawTool:null,toolBarColHtml:"<div id='mapTools'>    <ul>        <li id='t_layerList' class='tool_layerList'><a href='#'>图层</a></li>        <li id='t_legend' class='tool_legend'><a href='#'>图例</a></li>        <li id='t_clear' class='tool_clear'><a href='#'>清空</a></li>        <li id='t_basicGroup' class='tool_basicGroup'><a href='#'>工具<img src='images/map/Tools/arrow-down.png' id='t_basicGroup_flag' style='padding-left:3px;'></a>            <ul class='groupHide' id='dropdown_t_basicGroup'>               <li id='t_zoomIn' class='tool_zoomIn'><a href='#'>放大</a></li>               <li id='t_zoomOut' class='tool_zoomOut'><a href='#'>缩小</a></li>               <li id='t_distance' class='tool_distance'><a href='#'>测距</a></li>               <li id='t_area' class='tool_area'><a href='#'>测面</a></li>               <li id='t_scalebar' class='tool_scalebar'><a href='#'>比例尺</a></li>            </ul>        </li>        <li id='t_selectGroup' class='tool_selectGroup'><a href='#'>查询<img src='images/map/Tools/arrow-down.png' id='t_selectGroup_flag' style='padding-left:3px;'></a>            <ul class='groupHide' id='dropdown_t_selectGroup'>               <li id='t_selectPoint' class='tool_selectPoint'><a href='#'>点</a></li>               <li id='t_selectCircle' class='tool_selectCircle'><a href='#'>圆</a></li>               <li id='t_selectEllipse' class='tool_selectEllipse'><a href='#'>椭圆</a></li>               <li id='t_selectArea' class='tool_selectArea'><a href='#'>矩形</a></li>               <li id='t_selectPolygon' class='tool_selectPolygon'><a href='#'>多边形</a></li>            </ul>        </li>    </ul></div>",InitTool:function(o){this.map=o,this.createTools()},createTools:function(){var o=$("#tool_container").children();0<o.length&&o.remove(),$("#tool_container").append(G_Dci_Info.MapToolManager.toolBarColHtml),$("#t_basicGroup").mousemove(function(o){$("#t_basicGroup_flag").attr("src","images/map/Tools/arrow-up.png"),$("#dropdown_t_basicGroup").removeClass("groupHide"),$("#dropdown_t_basicGroup").addClass("groupShow")}),$("#t_basicGroup").mouseout(function(o){$("#t_basicGroup_flag").attr("src","images/map/Tools/arrow-down.png"),$("#dropdown_t_basicGroup").removeClass("groupShow"),$("#dropdown_t_basicGroup").addClass("groupHide")}),$("#t_selectGroup").mousemove(function(o){$("#t_selectGroup_flag").attr("src","images/map/Tools/arrow-up.png"),$("#dropdown_t_selectGroup").removeClass("groupHide"),$("#dropdown_t_selectGroup").addClass("groupShow")}),$("#t_selectGroup").mouseout(function(o){$("#t_selectGroup_flag").attr("src","images/map/Tools/arrow-down.png"),$("#dropdown_t_selectGroup").removeClass("groupShow"),$("#dropdown_t_selectGroup").addClass("groupHide")}),this.zoom_DrawTool=new l(this.map,{showTooltips:!0}),this.zoom_DrawTool.on("draw-complete",G_Dci_Info.MapToolManager.zoomDrawComplete),$("#t_zoomIn").click(function(){G_Dci_Info.MapToolManager.map.setMapCursor("url('"+getRootPath()+"images/map/cursor/zoomIn.cur'),auto"),G_Dci_Info.MapToolManager.zoom_DrawTool.activate(l.EXTENT),G_Dci_Info.MapToolManager.zoomDrawExtent(function(o){G_Dci_Info.MapToolManager.zoomInByExtent(o)})}),$("#t_zoomOut").click(function(){G_Dci_Info.MapToolManager.map.setMapCursor("url('"+getRootPath()+"images/map/cursor/zoomOut.cur'),auto"),G_Dci_Info.MapToolManager.zoom_DrawTool.activate(l.EXTENT),G_Dci_Info.MapToolManager.zoomDrawExtent(function(o){G_Dci_Info.MapToolManager.zoomOutByExtent(o)})}),$("#t_clear").click(function(){G_Dci_Info.MapToolManager.clearMap()}),MeasureToolBar=new MeasureToolBar(this.map),$("#t_scalebar").click(function(){$("#map_scalebar_coordinates").is(":hidden")?$("#map_scalebar_coordinates").show(500):$("#map_scalebar_coordinates").hide(500)}),$("#t_layerList").click(function(){$("#divLayerList").is(":hidden")?$.each(MapConfig.divShowToolList,function(o,a){"divLayerList"==a?$("#"+a).show(500):$("#"+a).hide()}):$("#divLayerList").hide(500)}),$("#t_legend").click(function(){$("#divLegend").is(":hidden")?$.each(MapConfig.divShowToolList,function(o,a){"divLegend"==a?$("#"+a).show(500):$("#"+a).hide()}):$("#divLegend").hide(500)})},zoomDrawComplete:function(o){G_Dci_Info.MapToolManager.zoom_DrawTool.deactivate(),G_Dci_Info.MapToolManager.map.setMapCursor("default"),G_Dci_Info.MapToolManager.zoomOnDrawEnd(o.geometry)},zoomDrawExtent:function(o){G_Dci_Info.MapToolManager.zoomOnDrawEnd=o},zoomInByExtent:function(o){G_Dci_Info.MapToolManager.map.setExtent(o.getExtent())},zoomOutByExtent:function(o){if(o.xmin!=o.xmax&&o.ymin!=o.ymax){var a=G_Dci_Info.MapToolManager.map.extent,e=Math.abs(a.xmin-a.xmax)/Math.abs(o.xmin-o.xmax),t=Math.abs(a.ymin-a.ymax)/Math.abs(o.ymin-o.ymax);a=t<=e?a.expand(e):a.expand(t),G_Dci_Info.MapToolManager.map.setExtent(a)}else 0<parseInt(G_Dci_Info.MapToolManager.map.getLevel())&&G_Dci_Info.MapToolManager.map.setLevel(parseInt(G_Dci_Info.MapToolManager.map.getLevel())-1)},clearMap:function(){this.map.graphics.clear();for(var o=0;o<this.map.graphicsLayerIds.length;o++){this.map.getLayer(this.map.graphicsLayerIds[o]).clear()}t.publish("clearMeasureLayer"),t.publish("clearQueryLayer"),this.map.infoWindow.hide(),this.map.setMapCursor("default")}}});