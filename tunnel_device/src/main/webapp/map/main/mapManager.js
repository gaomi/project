if(void 0===G_Dci_Info)var G_Dci_Info={};require(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","main/extentionGis/layer/ArcGisLocalLayer.js","main/extentionGis/layer/BaiDuLayer.js","main/extentionGis/layer/GaoDeLayer.js","main/extentionGis/layer/TianDiTuLayer.js"],function(e,l,s,y,n,t,o){G_Dci_Info.MapManager={mapDivId:null,map:null,layMap:null,initMapManager:function(e){this.mapDivId=e.id,this.map=e,this.layMap={tiled:"esri/layers/ArcGISTiledMapServiceLayer",dynamic:"esri/layers/ArcGISDynamicMapServiceLayer",image:"esri/layers/ArcGISImageServiceLayer",feature:"esri/layers/FeatureLayer",rss:"esri/layers/GeoRSSLayer",kml:"esri/layers/KMLLayer",webTiled:"esri/layers/WebTiledLayer",wms:"esri/layers/WMSLayer",wmts:"esri/layers/WMTSLayer"},this.map&&this._visitConfigMapLayers(MapConfig.baseMaps,MapConfig.layerListCol,l.hitch(this,function(e){this.createLayer(this.map,e)}))},_visitConfigMapLayers:function(e,a,i){s.forEach(e,function(e,a){e.isOperationalLayer=!1,i(e,a)},this);var r=[];this._formatLayerConfigInfo(a,r),s.forEach(r,function(e,a){e.isOperationalLayer=!0,i(e,a)},this)},_formatLayerConfigInfo:function(e,r){e&&$.each(e,function(e,a){if("Server"==a.iconType){if(a.visible){if(a.childNodeCol&&0<a.childNodeCol.length){var i=[];G_Dci_Info.MapManager._getVisibleLayers(a.childNodeCol,i),i&&0==i.length&&(i=[-1]),a.visibleLayers=i}}else a.visibleLayers=[-1];r.push(a)}else"Folder"==a.iconType&&a.childNodeCol&&0<a.childNodeCol.length&&G_Dci_Info.MapManager._formatLayerConfigInfo(a.childNodeCol,r)})},_getVisibleLayers:function(e,i){"object"==typeof e&&$.each(e,function(e,a){a.visible&&"Layer"==a.iconType&&i.push(a.url.substr(a.url.lastIndexOf("/")+1)),a.childNodeCol&&0<a.childNodeCol.length&&G_Dci_Info.MapManager._getVisibleLayers(a.childNodeCol,i)})},createLayer:function(a,i){var r=null;"gaoDe"==i.type?((r=new t({esriLayerType:i.layerFlag})).id=i.id,r.label=i.label,r.type=i.type,r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r),"img"==i.layerFlag&&((r=new t({esriLayerType:i.layerFlag+"_lab"})).id=i.id+"_remark",r.label=i.label,r.type=i.type+"_lab",r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r))):"baiDu"==i.type?((r=new n({esriLayerType:i.layerFlag})).id=i.id,r.label=i.label,r.type=i.type,r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r),"img"==i.layerFlag&&((r=new n({esriLayerType:i.layerFlag+"_lab"})).id=i.id+"_remark",r.label=i.label,r.type=i.type+"_lab",r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r))):"tianDiTu"==i.type?((r=new o({esriLayerType:i.layerFlag})).id=i.id,r.label=i.label,r.type=i.type,r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r),(r=new o({esriLayerType:i.layerFlag+"_lab"})).id=i.id+"_remark",r.label=i.label,r.type=i.type+"_lab",r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r)):"arcgisLocalSrv"==i.type?((r=new y({baseUrl:i.url,imgType:i.imgType})).id=i.id,r.label=i.label,r.type=i.type,r.visible=i.visible,r.isOperationalLayer=i.isOperationalLayer,a.addLayer(r)):require([this.layMap[i.type]],l.hitch(this,function(e){(r=new e(i.url)).id=i.id,r.label=i.label,r.type=i.type,r.isOperationalLayer=i.isOperationalLayer,r.visible=i.visible,i.visibleLayers&&0<i.visibleLayers.length&&r.setVisibleLayers(i.visibleLayers),a.addLayer(r)}))}}});